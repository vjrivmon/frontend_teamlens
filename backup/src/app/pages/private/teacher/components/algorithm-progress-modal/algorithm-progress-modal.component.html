<!-- Modal dedicado para el progreso del algoritmo -->
<p-dialog 
    [visible]="visible" 
    [modal]="true" 
    [closable]="isCompleted"
    [draggable]="false"
    [resizable]="false"
    [style]="{'width': '500px', 'max-width': '90vw'}"
    styleClass="algorithm-progress-dialog">
    
    <!-- Header personalizado -->
    <ng-template pTemplate="header">
        <div class="flex align-items-center gap-3 w-full">
            <i [class]="getStatusIcon()" [ngClass]="getStatusClass()" style="font-size: 1.5rem;"></i>
            <h4 class="m-0 font-semibold text-900">{{ getTitle() }}</h4>
        </div>
    </ng-template>
    
    <!-- Contenido principal -->
    <div class="flex flex-column align-items-center gap-4 py-4">
        
        <!-- Indicador de progreso visual -->
        <div *ngIf="!isCompleted" class="flex align-items-center justify-content-center">
            <p-progressSpinner 
                [style]="{'width': '60px', 'height': '60px'}" 
                strokeWidth="4" 
                fill="transparent"
                animationDuration="1.2s">
            </p-progressSpinner>
        </div>
        
        <!-- Icono de resultado final -->
        <div *ngIf="isCompleted" class="flex align-items-center justify-content-center">
            <div class="flex align-items-center justify-content-center w-4rem h-4rem border-round-md"
                 [ngClass]="{
                    'bg-green-100': isSuccess,
                    'bg-red-100': !isSuccess
                 }">
                <i [class]="getStatusIcon()" [ngClass]="getStatusClass()" style="font-size: 2rem;"></i>
            </div>
        </div>
        
        <!-- Mensaje de progreso o resultado -->
        <div class="text-center">
            <p class="text-lg font-medium text-900 mb-2 line-height-3">
                {{ progressMessage }}
            </p>
            
            <!-- Información adicional cuando está corriendo -->
            <div *ngIf="!isCompleted && (elapsedTime > 0 || estimatedTimeRemaining)" 
                 class="flex align-items-center justify-content-center gap-3 text-sm text-600">
                <div *ngIf="elapsedTime > 0" class="flex align-items-center gap-1">
                    <i class="pi pi-clock"></i>
                    <span>{{ elapsedTime }}s transcurridos</span>
                </div>
                <span *ngIf="elapsedTime > 0 && estimatedTimeRemaining">•</span>
                <span *ngIf="estimatedTimeRemaining">{{ estimatedTimeRemaining }}</span>
            </div>
            
            <!-- Información de éxito -->
            <div *ngIf="isCompleted && isSuccess" class="mt-3">
                <div class="bg-green-50 border-round-lg p-3">
                    <div class="flex align-items-center justify-content-center gap-2">
                        <i class="pi pi-users text-green-600"></i>
                        <span class="text-green-800 font-medium">
                            {{ groupsCreated }} grupo{{ groupsCreated === 1 ? '' : 's' }} creado{{ groupsCreated === 1 ? '' : 's' }}
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- Información de error -->
            <div *ngIf="isCompleted && !isSuccess && errorMessage" class="mt-3">
                <div class="bg-red-50 border-round-lg p-3">
                    <p class="text-red-800 text-sm m-0 line-height-3">{{ errorMessage }}</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer con botones -->
    <ng-template pTemplate="footer">
        <div class="flex justify-content-center gap-2 w-full">
            
            <!-- Botón de cancelar (solo mientras está corriendo) -->
            <p-button 
                *ngIf="!isCompleted"
                label="Cancelar" 
                icon="pi pi-times"
                class="p-button-outlined p-button-secondary"
                (onClick)="cancelAlgorithm()">
            </p-button>
            
            <!-- Botón de cerrar (solo cuando ha terminado) -->
            <p-button 
                *ngIf="isCompleted"
                [label]="isSuccess ? 'Ver Grupos' : 'Cerrar'" 
                [icon]="isSuccess ? 'pi pi-external-link' : 'pi pi-times'"
                [class]="isSuccess ? 'p-button-success' : 'p-button-secondary'"
                (onClick)="closeModal()">
            </p-button>
        </div>
    </ng-template>
    
</p-dialog> 